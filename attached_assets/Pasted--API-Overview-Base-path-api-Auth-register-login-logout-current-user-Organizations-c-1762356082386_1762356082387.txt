ğŸ”Œ API Overview

Base path: /api

Auth â€“ register / login / logout / current user

Organizations â€“ create org, invite users, update branding

Projects â€“ CRUD per org

Templates â€“ CRUD + versioning

JSAs â€“ create, edit, sign, PDF export, list / search

Files â€“ upload logo / signature images

Analytics â€“ summary counts + top hazards

Use Zod for request validation and JWT middleware for auth.

ğŸ–¥ Frontend Routes

/login, /register

/app/:orgSlug/dashboard

/app/:orgSlug/projects

/app/:orgSlug/templates (list + edit)

/app/:orgSlug/jsas/new (JSA builder)

/app/:orgSlug/jsas/:id (detail + signatures + PDF)

/app/:orgSlug/archive (search + export)

/app/:orgSlug/analytics

/app/:orgSlug/settings (org branding + users)

ğŸ§© Key Components

<JsaBuilder /> (step entry, hazards, controls, autosave)

<SignaturePad /> (using signature_pad)

<GpsCapture /> (optional)

<DataTable /> (for archive)

<TrendChart /> (for analytics)

<KpiCard /> (for dashboard metrics)

ğŸ” Auth & Roles
Action	Admin	Supervisor	Worker
Manage Org & Users	âœ…	âŒ	âŒ
Create/Edit Templates	âœ…	âœ…	âŒ
Create/Edit JSAs	âœ…	âœ…	View
Sign JSAs	âœ…	âœ…	âœ…
View Analytics	âœ…	âœ…	âŒ

Passwords â†’ hashed with Argon2.
JWT in httpOnly cookie.
Role checks on every org-scoped endpoint.

ğŸ“‘ PDF Export

Use puppeteer to render an HTML template containing:

Org logo + branding

Project name + location

Job steps, hazards, controls

Signatures (images + names + timestamps + GPS)

Store files in /uploads/pdfs/{orgId}/{jsaId}.pdf and save URL to DB.

ğŸ§  Analytics Endpoints

GET /api/orgs/:orgId/analytics/overview â†’

{
  "totalJSAs": 42,
  "byProject": [{ "project": "Site A", "count": 10 }],
  "topHazards": ["Fall", "Electrical", "Slips"],
  "signoffCompletionRate": 0.87
}

ğŸš€ Seed Data (Development)

Org: â€œAcme Constructionâ€

Users: admin@acme / supervisor@acme / worker@acme

Project: â€œDowntown Demoâ€

Template: â€œTrenching Safetyâ€

ğŸ§© Scripts & Commands

Root package.json:

{
  "scripts": {
    "dev": "concurrently \"npm --prefix ./backend run dev\" \"npm --prefix ./frontend run dev\"",
    "build": "npm --prefix ./frontend run build && npm --prefix ./backend run build",
    "seed": "npm --prefix ./backend run seed"
  }
}


Frontend: Vite dev server on 5173
Backend: Express API on 4000

âš™ï¸ Environment Variables
JWT_SECRET=change_me
PORT=4000
BASE_URL=http://localhost:4000
FILE_STORAGE_PATH=./uploads

âœ… Acceptance Checklist

Register / login works.

Admin can create org + invite users.

Supervisor can create JSA from template.

Worker can sign off with signature pad.

JSA PDF is generated and downloadable.

Archive search + analytics function.

UI mobile-friendly + offline draft autosave.

Deliverable:
A working Replit project running both frontend and backend via npm run dev.
Show local URLs and demo credentials on startup.